function hideLoader(){document.getElementById("loader").style.display="none"}var weatherApp=function(){function e(){return navigator.geolocation?void navigator.geolocation.getCurrentPosition(function(e){c=e.coords.latitude,s=e.coords.longitude;var n=document.createElement("script");n.type="text/javascript",n.src="http://api.openweathermap.org/data/2.5/weather?lat="+c+"&lon="+s+"&callback=myCallback&appid=1a30526b61791bf2a0ebd807b705d950",document.body.appendChild(n),window.myCallback=function(e){C=e,t()}}):void console.log("Geolocation API не поддерживается в вашем браузере")}function t(){C.coord.lat=c,C.coord.lon=s,C.lastUpdate=(new Date).getTime(),C.currentTempC=a(C.main.temp,"C"),C.currentTempF=a(C.main.temp,"F"),o(),localStorage.setItem("currentWeather",JSON.stringify(C)),n(),hideLoader()}function n(){l.innerHTML=C.name,i.innerHTML=C.sys.country,r(),g.style.backgroundImage="url('images/weather-icons/"+C.weather[0].icon+".png')",f.innerHTML=C.wind.speed,y.style.transform="rotate("+C.wind.deg+"deg)"}function a(e,t){var n;if("C"===t)n=300-e;else{if("F"!==t)return void console.log("Error! Wrong temperature scale!");n=9*e/5-459.67}return n}function o(){"C"===_?C.currentTemp=C.currentTempC:"F"===_?C.currentTemp=C.currentTempF:console.log("Error! setCurrentTemp function")}function r(){"C"===_?(p.classList.remove("active"),u.classList.add("active")):"F"===_?(u.classList.remove("active"),p.classList.add("active")):console.log("Error! How it happend? WTF???"),o(),m.innerHTML=C.currentTemp.toFixed(1)}var c,s,l=document.getElementsByClassName("city")[0],i=document.getElementsByClassName("country")[0],m=document.getElementsByClassName("temperature__value")[0],d=document.getElementsByClassName("temperature__scales")[0],u=document.getElementsByClassName("temperature__scale_c")[0],p=document.getElementsByClassName("temperature__scale_f")[0],g=document.getElementsByClassName("weather-icon")[0],f=document.getElementsByClassName("wind__speed")[0],y=document.getElementsByClassName("wind__direction")[0],C=JSON.parse(localStorage.getItem("currentWeather")),v=(new Date).getTime(),_=JSON.parse(localStorage.getItem("currentTempScale"))||"C";C?C.lastUpdate+6e4>v?(console.log("1 minute not left"),n(),hideLoader()):(console.log("1 minute left"),e()):(console.log("It's first init"),e()),d.addEventListener("click",function(e){var t=e.target;"A"===t.tagName&&(e.preventDefault(),t.classList.contains("temperature__scale_c")?(_="C",r()):t.classList.contains("temperature__scale_f")?(_="F",r()):console.log("Error! What did you click?!?!?"))}),window.onunload=function(){localStorage.setItem("currentTempScale",JSON.stringify(_))}};weatherApp();