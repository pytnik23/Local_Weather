function hideLoader(){document.getElementById("loader").style.display="none"}var weatherApp=function(){function e(){return navigator.geolocation?void navigator.geolocation.getCurrentPosition(function(e){s=e.coords.latitude,c=e.coords.longitude;var n="onload"in new XMLHttpRequest?XMLHttpRequest:XDomainRequest,o=new n,r="https://api.darksky.net/forecast/"+C+"/"+s+","+c;o.open("GET",r,!0),o.onload=function(){_=JSON.parse(this.responseText),console.log(_),t()},o.onerror=function(){alert("Ошибка "+this.status)},o.send()}):void console.log("Geolocation API не поддерживается в вашем браузере")}function t(){_.lastUpdate=(new Date).getTime(),_.currentTempC=_.currently.temperature,_.currentTempF=o(_.main.temp,"F"),r(),localStorage.setItem("currentWeather",JSON.stringify(_)),n(),hideLoader()}function n(){l.innerHTML=_.name,i.innerHTML=_.sys.country,a(),p.style.backgroundImage="url('images/weather-icons/"+_.weather[0].icon+".png')",f.innerHTML=_.wind.speed,y.style.transform="rotate("+_.wind.deg+"deg)"}function o(e,t){var n;if("C"===t)n=300-e;else{if("F"!==t)return void console.log("Error! Wrong temperature scale!");n=9*e/5-459.67}return n}function r(){"C"===T?_.currentTemp=_.currentTempC:"F"===T?_.currentTemp=_.currentTempF:console.log("Error! setCurrentTemp function")}function a(){"C"===T?(g.classList.remove("active"),d.classList.add("active")):"F"===T?(d.classList.remove("active"),g.classList.add("active")):console.log("Error! How it happend? WTF???"),r(),m.innerHTML=_.currentTemp.toFixed(1)}var s,c,l=document.getElementsByClassName("city")[0],i=document.getElementsByClassName("country")[0],m=document.getElementsByClassName("temperature__value")[0],u=document.getElementsByClassName("temperature__scales")[0],d=document.getElementsByClassName("temperature__scale_c")[0],g=document.getElementsByClassName("temperature__scale_f")[0],p=document.getElementsByClassName("weather-icon")[0],f=document.getElementsByClassName("wind__speed")[0],y=document.getElementsByClassName("wind__direction")[0],_=JSON.parse(localStorage.getItem("currentWeather")),v=(new Date).getTime(),T=JSON.parse(localStorage.getItem("currentTempScale"))||"C",C="07384ebfcecc402230f46dd9b2267474";_?_.lastUpdate+6e4>v?(console.log("1 minute not left"),n(),hideLoader()):(console.log("1 minute left"),e()):(console.log("It's first init"),e()),u.addEventListener("click",function(e){var t=e.target;"A"===t.tagName&&(e.preventDefault(),t.classList.contains("temperature__scale_c")?(T="C",a()):t.classList.contains("temperature__scale_f")?(T="F",a()):console.log("Error! What did you click?!?!?"))}),window.onunload=function(){localStorage.setItem("currentTempScale",JSON.stringify(T))}};weatherApp();